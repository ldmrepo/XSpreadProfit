### **ë“±ë¡ê¸° (Processor) ìƒì„¸ ìŠ¤í™**

---

## **1. ì„¤ê³„ ëª©í‘œ**

-   **ê³ ì† ë°ì´í„° ì²˜ë¦¬**: ìˆ˜ì§‘ê¸°ì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê²€ì¦, ì •ê·œí™”, ì €ì¥.
-   **íš¨ìœ¨ì  ë©”ëª¨ë¦¬ ê´€ë¦¬**: ê³ ì • ë©”ëª¨ë¦¬ í• ë‹¹ê³¼ íë¥¼ í†µí•´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€.
-   **ì§€ì—° ìµœì†Œí™”**: ë°ì´í„° ì €ì¥ ë° ì²˜ë¦¬ì—ì„œ ìµœì†Œ ì§€ì—° ì‹œê°„(<100ms) ë‹¬ì„±.
-   **ì•ˆì •ì„±**: ì¥ì•  ë°œìƒ ì‹œ ë³µêµ¬ ì ˆì°¨ë¥¼ í†µí•´ ì¤‘ë‹¨ ì—†ëŠ” ë°ì´í„° ì²˜ë¦¬.
-   **í™•ì¥ì„±**: ê±°ë˜ì†Œ ì¶”ê°€ ë° ì²˜ë¦¬ëŸ‰ ì¦ê°€ì— ë”°ë¥¸ í™•ì¥ ìš©ì´ì„±.

---

## **2. ê¸°ëŠ¥ ëª…ì„¸**

### **2.1 ë°ì´í„° ì²˜ë¦¬**

-   **ë°ì´í„° ì •ê·œí™”**: ìˆ˜ì§‘ê¸°ì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ë¥¼ í‘œì¤€í™”ëœ í˜•ì‹ìœ¼ë¡œ ë³€í™˜.
-   **ë°ì´í„° ê²€ì¦**: ë°ì´í„° í˜•ì‹ê³¼ ë‚´ìš©ì˜ ìœ íš¨ì„± í™•ì¸.
-   **Redis ì €ì¥**: ê²€ì¦ëœ ë°ì´í„°ë¥¼ Redisì— ì €ì¥.

### **2.2 ë©”ëª¨ë¦¬ ê´€ë¦¬**

-   **ê³ ì • ë©”ëª¨ë¦¬ í**:
    -   í í¬ê¸°ë¥¼ ê³ ì •í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì œí•œ.
    -   íê°€ ê°€ë“ ì°° ê²½ìš°, ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ ëŒ€ì²´ (ë¡œí…Œì´ì…˜ ë°©ì‹).
-   **ê°€ë¹„ì§€ ì½œë ‰ì…˜ ìµœì†Œí™”**:
    -   ë©”ëª¨ë¦¬ í• ë‹¹ ì‹œ ê³ ì • í¬ê¸°ë¥¼ ì‚¬ìš©í•´ GC ë¶€í•˜ ê°ì†Œ.

### **2.3 ì¥ì•  ì²˜ë¦¬**

-   **ë“±ë¡ê¸° ì¥ì• **:
    -   Redisì™€ ì—°ê²° ì‹¤íŒ¨ ì‹œ, ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ íì— ì €ì¥.
    -   Redis ì—°ê²° ë³µêµ¬ í›„ í ë°ì´í„°ë¥¼ ì¬ì²˜ë¦¬.
-   **ìˆ˜ì§‘ê¸° ì¥ì• **:
    -   ìˆ˜ì§‘ê¸°ê°€ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ì§€ ëª»í•  ê²½ìš°, ë¡œê·¸ ê¸°ë¡ ë° ë³µêµ¬ ëŒ€ê¸°.
-   **ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨**:
    -   ê²€ì¦ ì‹¤íŒ¨ ë˜ëŠ” ë°ì´í„° ì €ì¥ ì‹¤íŒ¨ ì‹œ ì‹¤íŒ¨ íì— ì €ì¥ ë° ì¬ì²˜ë¦¬.

### **2.4 ë©”íŠ¸ë¦­ ê´€ë¦¬**

-   **í•µì‹¬ ë©”íŠ¸ë¦­**:
    -   ì²˜ë¦¬ëœ ë°ì´í„° ê±´ìˆ˜
    -   ì‹¤íŒ¨í•œ ë°ì´í„° ê±´ìˆ˜
    -   í‰ê·  ì²˜ë¦¬ ì‹œê°„
    -   í ì‚¬ìš©ë¥ 
-   **ë³´ê³  ë°©ì‹**:
    -   ì •ê¸°ì ìœ¼ë¡œ `MetricManager`ì— ë©”íŠ¸ë¦­ ì „ì†¡.
    -   ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ ì‹¤ì‹œê°„ ì²˜ë¦¬ëŸ‰ ë° ì—ëŸ¬ìœ¨ ë³´ê³ .

---

## **3. ë°ì´í„° íë¦„**

```plaintext
1. ìˆ˜ì§‘ê¸°ì—ì„œ ë©”ì‹œì§€ë¥¼ ì´ë²¤íŠ¸ë¡œ ë“±ë¡ê¸°ì— ì „ë‹¬.
2. ë“±ë¡ê¸°ëŠ” ë°ì´í„° ì •ê·œí™” ë° ê²€ì¦ ìˆ˜í–‰.
3. Redis ì €ì¥:
   - ì €ì¥ ì„±ê³µ: ì²˜ë¦¬ ì™„ë£Œë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸.
   - ì €ì¥ ì‹¤íŒ¨: ë°ì´í„° ì‹¤íŒ¨ íì— ì €ì¥.
4. ì¥ì•  ë°œìƒ ì‹œ:
   - ë³µêµ¬ ì ˆì°¨ ìˆ˜í–‰ (ë©”ëª¨ë¦¬ í â†’ Redis).
5. ë©”íŠ¸ë¦­ ë³´ê³ :
   - ì²˜ë¦¬ëŸ‰, ì‹¤íŒ¨ìœ¨, í ìƒíƒœë¥¼ ê´€ë¦¬ê¸°ì— ì‹¤ì‹œê°„ ë³´ê³ .
```

---

## **4. ì£¼ìš” ë©”ì„œë“œ ë° ì¸í„°í˜ì´ìŠ¤**

### **4.1 ë©”ì„œë“œ ì •ì˜**

```typescript
interface Processor {
    // ë°ì´í„° ì²˜ë¦¬
    processData(data: any): Promise<void>;

    // ë°ì´í„° ê²€ì¦ ë° ì •ê·œí™”
    validateData(data: any): boolean;
    normalizeData(data: any): any;

    // ì¥ì•  ë³µêµ¬
    recover(): Promise<void>;

    // ë©”íŠ¸ë¦­ ê´€ë¦¬
    collectMetrics(): Metrics;
    reportMetrics(): void;
}
```

---

### **4.2 ì£¼ìš” ë©”ì„œë“œ êµ¬í˜„**

#### **ë°ì´í„° ì²˜ë¦¬**

```typescript
async processData(data: any): Promise<void> {
    try {
        // ë°ì´í„° ê²€ì¦
        if (!this.validateData(data)) {
            throw new Error("ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨");
        }

        // ë°ì´í„° ì •ê·œí™”
        const normalizedData = this.normalizeData(data);

        // Redis ì €ì¥
        await this.redisClient.insert(normalizedData);
        this.updateMetrics({ processed: 1, failed: 0 });
    } catch (error) {
        console.error("ë°ì´í„° ì²˜ë¦¬ ì‹¤íŒ¨:", error);
        this.updateMetrics({ processed: 0, failed: 1 });

        // ì‹¤íŒ¨ íì— ì €ì¥
        this.failureQueue.push(data);
    }
}
```

#### **ë©”ëª¨ë¦¬ ê´€ë¦¬**

```typescript
private initializeQueue(size: number): void {
    this.queue = new FixedSizeQueue(size);
    this.failureQueue = new FixedSizeQueue(size);
}
```

#### **ì¥ì•  ë³µêµ¬**

```typescript
async recover(): Promise<void> {
    console.log("Redis ë³µêµ¬ ì‹œë„ ì¤‘...");
    while (this.failureQueue.size() > 0) {
        try {
            const failedData = this.failureQueue.pop();
            if (failedData) {
                await this.redisClient.insert(failedData);
                console.log("ë³µêµ¬ ì„±ê³µ:", failedData);
            }
        } catch (error) {
            console.error("ë³µêµ¬ ì‹¤íŒ¨:", error);
            this.failureQueue.push(failedData); // ë³µêµ¬ ì‹¤íŒ¨ ì‹œ ë‹¤ì‹œ íì— ì¶”ê°€
            break; // ì—°ê²° ë³µêµ¬ í›„ ì¬ì‹œë„
        }
    }
}
```

---

## **5. ìƒíƒœ ë° ë©”íŠ¸ë¦­ ê´€ë¦¬**

### **5.1 ìƒíƒœ ê´€ë¦¬**

```typescript
interface HealthStatus {
    status: "healthy" | "unhealthy";
    currentState: StateType;
    lastStateChange: number;
    uptime: number;
    failureRate: number;
}
```

### **5.2 ë©”íŠ¸ë¦­ ê´€ë¦¬**

```typescript
interface Metrics {
    processed: number; // ì²˜ë¦¬ëœ ë°ì´í„° ìˆ˜
    failed: number; // ì‹¤íŒ¨í•œ ë°ì´í„° ìˆ˜
    queueUsage: number; // í ì‚¬ìš©ë¥  (%)
    avgProcessingTime: number; // í‰ê·  ì²˜ë¦¬ ì‹œê°„ (ms)
}
```

---

## **6. ì¥ì•  ì²˜ë¦¬ ì‹œë‚˜ë¦¬ì˜¤**

### **6.1 ì¥ì•  ìœ í˜•**

| ì¥ì•  ìœ í˜•        | ë³µêµ¬ ë°©ì‹                          | ì²˜ë¦¬ ì¤‘ë‹¨ ì—¬ë¶€ |
| ---------------- | ---------------------------------- | -------------- |
| Redis ì—°ê²° ì¥ì•   | ë©”ëª¨ë¦¬ íì— ì €ì¥ í›„ ë³µêµ¬ ì‹œ ì¬ì²˜ë¦¬ | ì¤‘ë‹¨ ì—†ìŒ      |
| ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨ | ì‹¤íŒ¨ íì— ì €ì¥ ë° ë¡œê·¸ ê¸°ë¡        | ì¤‘ë‹¨ ì—†ìŒ      |
| ì²˜ë¦¬ëŸ‰ ì´ˆê³¼      | íì—ì„œ ì˜¤ë˜ëœ ë°ì´í„° êµì²´          | ì¤‘ë‹¨ ì—†ìŒ      |
| ìˆ˜ì§‘ê¸° ì¥ì•       | ëŒ€ì²´ ë©”ì‹œì§€ í ì‚¬ìš©                | ì¤‘ë‹¨ ì—†ìŒ      |

---

## **7. í™•ì¥ ê³ ë ¤ì‚¬í•­**

1. **ë‹¤ì¤‘ ë“±ë¡ê¸° ì§€ì›**:
    - í í¬ê¸°ì™€ ì²˜ë¦¬ëŸ‰ì— ë”°ë¼ ë“±ë¡ê¸° ìˆ˜ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì •.
2. **ë¡œë“œ ë°¸ëŸ°ì‹±**:
    - ë°ì´í„° ì²˜ë¦¬ ë¶€í•˜ë¥¼ ê· ë“± ë¶„ë°°í•˜ê¸° ìœ„í•´ ë©”ì‹œì§€ í í™œìš©.
3. **ì¥ì•  ì•Œë¦¼**:
    - ì¥ì•  ë°œìƒ ì‹œ, ì‹¤ì‹œê°„ ì•Œë¦¼ì„ í†µí•´ ì¦‰ê° ëŒ€ì‘ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •.

---

## **8. ê¸°ëŒ€ íš¨ê³¼**

1. **ê³ ì„±ëŠ¥ ì²˜ë¦¬**:
    - ê³ ì • ë©”ëª¨ë¦¬ ê´€ë¦¬ì™€ íš¨ìœ¨ì ì¸ í ì„¤ê³„ë¡œ ì²˜ë¦¬ëŸ‰ ìµœì í™”.
2. **ì•ˆì •ì„± ê°•í™”**:
    - ì¥ì•  ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜ê³¼ ë…ë¦½ì ì¸ ì„¤ê³„ë¡œ ì•ˆì •ì ì¸ ì‹œìŠ¤í…œ ìš´ì˜.
3. **í™•ì¥ì„± í™•ë³´**:
    - ê±°ë˜ì†Œ ì¶”ê°€ ë° ì²˜ë¦¬ëŸ‰ ì¦ê°€ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘.

---

ì¶”ê°€ì ì¸ ìš”êµ¬ì‚¬í•­ì´ë‚˜ ìˆ˜ì •ì‚¬í•­ì´ ìˆë‹¤ë©´ ë§ì”€í•´ì£¼ì„¸ìš”. ğŸš€
